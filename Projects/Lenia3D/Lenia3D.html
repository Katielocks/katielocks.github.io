<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,height=device-height, initial-scale=1.0">
  <script type="text/javascript" src="./dist/animals3D.js"></script>
  <title>Lenia3D</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="./public/styles.css">
</head>
<body>
<div id = "wrapper" class = "wrapper">
  <div id = "loading" class = "loading">
        <div id = "loader" class = "loader"></div>
  </div>
  <div class = "topbar">
    <div class="sidebar-collapse-container">
      <button id = "toggleSidebar" onclick = "lenia.UI.toggleSidebar();"class="sidebar-collapse-button"></button>
  </div>
  <div class="sidebar-collapse-container">
    <button id = "toggleLayout" onclick = "lenia.UI.toggleLayout()" class="sidebar-collapse-button" >
      <img class="icon row-icon"></img>
      <img class="icon col-icon"></img>
    </button>
</div>
    <div class = "topbar-text">
      <b style="font-weight:bold;">Lenia3D</b>
    </div>
    <div class = "topbar-right-align">
      <div class = "switch-button-container" style = "font-size: 16px;">
        <button class="button switch-button" onclick = " lenia.UI.toggleRenderDimension(this)" id = "render-dimension-button-2D"> 2D </button>
        <button class="button switch-button" onclick = " lenia.UI.toggleRenderDimension(this)" id = "render-dimension-button-3D"> 3D </button>
      </div>  
    <div id="playcontrol" class="play-controls-topbar">
      <label id="play-button" class="play-button-topbar">
        <input type="checkbox" id="play-button-checkbox" class="play-button-checkbox" hidden>
        <img src="./public/assets/images/startbutton.png" class="play-button-image">
      </label>
      <button class="button reset-button" onclick="lenia.reset()" id ="reset"></button>
    </div>
    </div>
  </div>
    <nav id="sidebar" class="sidebar">
      <ul class="sidebarmenu">
        <li class="nav-item">
          <a class="nav-link" aria-current="page" href="#" onclick="lenia.UI.toggleMenu('generate')" aria-label="Generate">
            <img src="./public/assets/images/generate.png" id = "generate" alt="Generate Icon" class="nav-icon">
            <span class="nav-link-text">Generate</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#"  onclick="lenia.UI.toggleMenu('edit')" aria-label="Edit">
            <img src="./public/assets/images/edit.png" id = "edit" alt="Edit Icon" class="nav-icon">
            <span class="nav-link-text">Edit</span>
          </a>
        </li>
      </ul>
    </nav>
  <div id = "main" class="main">
    <div id = "menu-container" class = "menu-container"> 
      <div id = "menu-topbar" class = "menu-topbar">
        <label id= "header" class = "subheader-label" style = "margin: auto 0 0 3%">
          Pregenerated Patterns
        </label>
        <div class = "switch-button-container">
          <button class="button switch-button " id = "switch-button-generated" onclick="lenia.UI.editMenu(lenia.UI.menumodes['generate'])"> Generate</button>
          <button class="button switch-button " id = "switch-button-pregenerated" onclick="lenia.UI.editMenu(lenia.UI.menumodes['pregenerated'])">Pregenerated</button>
        </div>  
      </div>
      <div id = "menu" class = "menu-cont">

        <div id = "seed-input-container" class = "container generateswitch" style = "border-top : 0">
            <input  id="seedinput" type = "text" oninput = " this.value = lenia.UI.validateData(this.value,'int',28)"class= "seed-input">  
        </div>
        <div id = "dimensions-container" class = "container">
          <div class="subheader">
            <div class = "dim-container">
              <label for="dim" id = "dim">0</label>
            </div>
          </div>
        </div>
        <div id = "generate-container" class=" container"> 
           <div class="subheader">
            <label class = "subheader-label" style="font-size: 2vh;">
              Random
              <label class = "sub-text"> 
                Set the Range and Density of Values
              </label>
            </label>
           </div>
            <div class="parameter-row">
              <label type = "text" class = "paras-label " style="font-size:1.5vh; width : 8ch;min-width: 8ch;" for="ClusterSize">Range</label>
              <div class = "range-container">
                  <input type="range" class = "range min" id = "min" value = 0 >
                  <input type="range" class = "range max" id = "max" value = 100>
              </div>
              <div class="genRangeInputContainer">
                <input class = "para-input" id="cluster-min-value" value = 0>
                <span>,</span>
                <input class = "para-input"  id="cluster-max-value" value = 100>
              </div>
            </div>
            <div class="parameter-row">
              <label class="paras-label" style="font-size:1.5vh; width : 8ch;min-width: 8ch;"  for="ClusterSizeZ">Density</label>
              <input type="range" class = "single-range" id="densityslider" min="0" max="1" step="0.001">
              <input id="densitytext" type="text" class="para-input">
            </div>
      </div>
        <div id = "parameters-container" class = "container">
          <div class="subcontainer">
            <div class="parameter-row time-row">
              <label class="paras-label"  style="font-size:1.5vh; width : 8ch;min-width: 8ch;" for="ClusterSizeZ">Time</label>
              <div class = "time-bar" id = "time-bar">
                <button class="button" onclick ="lenia.params['T'] = parseInt(this.innerText); lenia.UI.updatet()" id="time-button"> 1</button>
                <button class="button" onclick ="lenia.params['T'] = parseInt(this.innerText); lenia.UI.updatet()" id="time-button">2</button>
                <button class="button" onclick ="lenia.params['T'] = parseInt(this.innerText); lenia.UI.updatet()" id="time-button">3</button>
                <button class="button" onclick ="lenia.params['T'] = parseInt(this.innerText); lenia.UI.updatet()" id="time-button">4</button>
                <button class="button" onclick ="lenia.params['T'] = parseInt(this.innerText); lenia.UI.updatet()" id="time-button">5</button>
                <button class="button" onclick ="lenia.params['T'] = parseInt(this.innerText); lenia.UI.updatet()" id="time-button">10</button>
                <button class="button" onclick ="lenia.params['T'] = parseInt(this.innerText); lenia.UI.updatet()" id="time-button">20</button>
                <button class="button" onclick ="lenia.params['T'] = parseInt(this.innerText); lenia.UI.updatet()" id="time-button">50</button>
                <button class="button" onclick ="lenia.params['T'] = parseInt(this.innerText); lenia.UI.updatet()" id="time-button">100</button>
              </div>
              <input id="timeres" type="text" class="para-input" oninput="this.value = lenia.UI.validateData(this.value,'int',[0,100,1])" 
                                                                 onblur="lenia.UI.validateInput(this,'int',[0,100,1]);lenia.params['T'] = this.value; 
                                                                 lenia.UI.updatet()">
            </div>
          </div>
          <div class = "subcontainer">
            <div class="subheader">
                <label class = "subheader-label" style="font-size: 2vh;">
                  Kernel
                  <label class = "sub-text"> 
                    Edit parameters
                  </label>
                </label>
                <div class = "parameter-button-container">
                  Radius  : 
                    <div class="parameter-buttons">
                      <button class="button button-dark" id="radius-sub-button">-</button>
                      <div id="radius">0</div>
                      <button class="button button-dark" id="radius-add-button">+</button>
                    </div>
              </div>
            </div>
            <div class="parameter-row growth-row">
              <label class="paras-label" for="mu">&mu;</label>
              <input type="range" class = "single-range" id="muslider" min="0" max="1" step="0.0001">
              <input id="mutext" type="text" class="para-input" style="width: 6ch">
            </div>
            <div class="parameter-row growth-row">  
              <label class="paras-label" for="sigma">&sigma;</label>
              <input type="range" class = "single-range" id="sigmaslider" min="0" max="1" step="0.0001">
              <input id="sigmatext" type="text" class="para-input" style="width: 6ch">
            </div>

          </div>
          <div class =  "subcontainer" >
            <div class="subheader">
              <label class = "subheader-label" style = "margin-left:2%" >
                &beta;
              </label>
              <div class = "parameter-button-container">
                <div class="parameter-buttons">
                  <button class="button button-dark" id="bdim-sub-button">-</button>
                  <div id="bdim">0</div>
                  <button class="button button-dark " id="bdim-add-button">+</button>
                </div>
              </div>  
            </div>
            <div class = "subcontainer" style="margin-left: 2%; width: 98%" id ="bcontainer"></div>
          </div>
          
        </div>
        <div id="AnimalWindow" class="animalWindow">
          <ul id="AnimalList" class="animalList"></ul>
        </div>
        <button class = "generate-button  button" id="generate-button" onclick="lenia.setparams();lenia.tensor.generateRandomGrid()"> Generate </button>
      </div>
    </div>
    <div id = "simcont" class = "simulation-container">
      <div id = "sim" class = "simulation">
        <div class = "sim-topbar">
          <div class= "seed-container" id = "seed" >111</div>
          <div class = "counter-container">
              <div class= "subcounter-container" id="gen">0</div>
              <div class= "subcounter-container"  id="frame">0</div>
              <div class= "subcounter-container"  id="time">0</div>
            </div>
          </div>
        </div>  

        <canvas id="canvas" class="canvas"></canvas>  
        <div id = sim-bottombar class = "bottom-bar">
          <div id="playcontrol" class="play-controls">
            <label id="play-button" class="play-button">
              <input type="checkbox" id="play-button-checkbox" class="play-button-checkbox" hidden>
              <img src="./public/assets/images/startbutton.png" class="play-button-image">
            </label>
            <button class="button reset-button" id ="reset" onclick="lenia.reset()"  ></button>
          </div>
      </div>

      </div>

    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"> </script>

<script type="module">
  import { Lenia } from './dist/lenia.js';
  
  window.lenia = new Lenia();
  
  // …
  if (animalArr !== null) {
    window.lenia.tensor.load.SelectAnimalID(40);
  } else {
    window.lenia.tensor.randomGrid();
    window.lenia.tensor.generateKernel();
  }
  
  window.lenia.mesh.render();
</script>
</body>
</html>
